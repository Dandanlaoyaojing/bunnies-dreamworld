# 网络问题解决指南

## 🚨 问题描述
您遇到的错误信息：
```
API请求失败: {errMsg: "request:fail timeout"}
API状态检查结果: {success: false, error: "网络请求失败: request:fail timeout"}
```

这是一个典型的网络超时问题，通常由以下原因引起：

## 🔍 问题分析

### 1. 网络连接问题
- **WiFi连接不稳定**：信号弱或路由器问题
- **移动网络问题**：4G/5G信号不稳定
- **网络权限**：应用没有网络访问权限

### 2. API服务问题
- **服务器响应慢**：DeepSeek API服务器负载高
- **请求超时**：网络延迟过高
- **API限制**：请求频率过高被限制

### 3. 应用配置问题
- **超时设置**：请求超时时间设置过短
- **重试机制**：没有重试机制处理临时失败

## 🛠️ 解决方案

### 方案一：使用网络诊断工具（推荐）

#### 步骤1：打开网络诊断
1. 进入 **账户管理** 页面
2. 点击 **网络诊断工具**
3. 等待自动诊断完成

#### 步骤2：查看诊断结果
系统会自动检查：
- ✅ 网络连接状态
- ✅ AI服务连接
- ✅ API功能测试

#### 步骤3：根据结果处理
- **如果网络连接失败**：检查WiFi或移动网络
- **如果AI服务连接失败**：稍后重试或检查网络设置
- **如果API功能测试失败**：使用本地标签生成功能

### 方案二：手动检查网络

#### 1. 检查网络连接
```
设置 → WiFi → 检查连接状态
设置 → 移动网络 → 检查数据连接
```

#### 2. 测试网络速度
- 打开浏览器访问其他网站
- 检查网络是否正常
- 尝试切换网络（WiFi ↔ 移动网络）

#### 3. 重启网络设置
- 关闭WiFi后重新连接
- 重启移动数据
- 重启路由器（如果是WiFi问题）

### 方案三：应用设置优化

#### 1. 使用本地功能
当AI服务不可用时，应用会自动使用本地标签生成功能：
- 基于关键词的智能标签
- 本地算法分析
- 无需网络连接

#### 2. 重试机制
我已经优化了AI服务，添加了：
- **自动重试**：失败后自动重试3次
- **递增延迟**：每次重试间隔递增
- **超时设置**：30秒超时时间
- **错误处理**：详细的错误信息

## 🔧 技术优化

### 已实现的改进

#### 1. 网络请求优化
```javascript
// 重试机制
const maxRetries = 3
const retryDelay = 1000 // 1秒

// 超时设置
timeout: 30000 // 30秒超时

// 错误处理
if (error.errMsg.includes('timeout')) {
  errorMessage = '请求超时，请检查网络连接'
}
```

#### 2. 网络状态检测
```javascript
// 检查网络状态
const networkStatus = await this.checkNetworkStatus()
if (!networkStatus.isConnected) {
  return { success: false, error: '网络连接不可用' }
}
```

#### 3. 降级处理
```javascript
// API不可用时使用本地功能
if (result.success) {
  return result
} else {
  return this.generateLocalTags(content, category)
}
```

## 📱 使用建议

### 网络环境优化
1. **使用稳定网络**：优先使用WiFi连接
2. **避免网络高峰**：避开网络使用高峰期
3. **检查信号强度**：确保网络信号良好

### 应用使用技巧
1. **分批操作**：避免连续大量AI请求
2. **使用本地功能**：网络不好时使用本地标签生成
3. **定期检查**：使用网络诊断工具定期检查

### 应急处理
1. **离线模式**：网络完全不可用时使用离线功能
2. **手动标签**：手动添加标签代替AI生成
3. **稍后重试**：网络恢复后重新尝试

## 🚀 预防措施

### 1. 定期网络检查
- 使用网络诊断工具
- 检查网络连接状态
- 监控API服务状态

### 2. 网络环境优化
- 使用稳定的网络环境
- 避免网络拥堵时段
- 保持网络设备良好状态

### 3. 应用设置
- 定期更新应用
- 检查权限设置
- 清理应用缓存

## 📞 技术支持

### 如果问题持续存在
1. **收集信息**：
   - 网络类型（WiFi/移动网络）
   - 错误信息截图
   - 网络诊断结果

2. **联系支持**：
   - 邮箱：support@rabbitnotes.com
   - 微信：RabbitNotes2024

3. **提供信息**：
   - 设备型号和系统版本
   - 网络环境描述
   - 问题复现步骤

## 🎯 快速解决检查清单

- [ ] 检查网络连接状态
- [ ] 使用网络诊断工具
- [ ] 尝试切换网络
- [ ] 重启网络设置
- [ ] 使用本地功能
- [ ] 稍后重试
- [ ] 联系技术支持

## 💡 临时解决方案

### 立即可用的功能
1. **本地标签生成**：无需网络连接
2. **手动标签添加**：完全离线操作
3. **笔记编辑**：所有基础功能正常
4. **数据管理**：本地数据操作正常

### 网络恢复后
1. **重新尝试AI功能**
2. **使用网络诊断工具验证**
3. **创建数据备份**

---

*按照以上步骤操作，您应该能够解决网络超时问题。如果问题持续存在，请使用网络诊断工具获取详细信息，或联系技术支持。*

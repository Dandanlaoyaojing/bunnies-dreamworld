<!--pages/compatibility-test/compatibility-test.wxml-->
<view class="container">
  <view class="header">
    <text class="title">ğŸ”§ å…¼å®¹æ€§æµ‹è¯•</text>
    <text class="subtitle">æ£€æŸ¥å¼€å‘è€…å·¥å…·å’ŒåŸºç¡€åº“å…¼å®¹æ€§</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{isLoading}}" class="loading">
    <text>ğŸ”„ æ­£åœ¨æ£€æŸ¥å…¼å®¹æ€§...</text>
  </view>

  <!-- é”™è¯¯ä¿¡æ¯ -->
  <view wx:if="{{errorMessage}}" class="error-section">
    <view class="error-header">
      <text class="error-title">âŒ æµ‹è¯•å¤±è´¥</text>
      <button class="copy-btn" bindtap="onCopyError">å¤åˆ¶é”™è¯¯</button>
    </view>
    <text class="error-message">{{errorMessage}}</text>
  </view>

  <!-- æ£€æŸ¥ç»“æœ -->
  <view wx:if="{{checkResults}}" class="results-section">
    
    <!-- æ€»ä½“çŠ¶æ€ -->
    <view class="overall-status {{checkResults.overallCompatible ? 'success' : 'warning'}}">
      <text class="status-icon">{{checkResults.overallCompatible ? 'âœ…' : 'âš ï¸'}}</text>
      <text class="status-text">
        {{checkResults.overallCompatible ? 'å…¼å®¹æ€§è‰¯å¥½' : 'å­˜åœ¨å…¼å®¹æ€§é—®é¢˜'}}
      </text>
    </view>

    <!-- å¼€å‘è€…å·¥å…·æ£€æŸ¥ -->
    <view class="check-item">
      <view class="check-header">
        <text class="check-title">ğŸ› ï¸ å¼€å‘è€…å·¥å…·</text>
        <text class="check-status {{checkResults.results.devTools.isCompatible ? 'success' : 'error'}}">
          {{checkResults.results.devTools.isCompatible ? 'æ­£å¸¸' : 'å¼‚å¸¸'}}
        </text>
      </view>
      <view wx:if="{{checkResults.results.devTools.issues.length > 0}}" class="issues">
        <text wx:for="{{checkResults.results.devTools.issues}}" wx:key="*this" class="issue-item">
          â€¢ {{item}}
        </text>
      </view>
    </view>

    <!-- ç½‘ç»œç¯å¢ƒæ£€æŸ¥ -->
    <view class="check-item">
      <view class="check-header">
        <text class="check-title">ğŸŒ ç½‘ç»œç¯å¢ƒ</text>
        <text class="check-status {{checkResults.results.network.isOnline ? 'success' : 'error'}}">
          {{checkResults.results.network.isOnline ? 'æ­£å¸¸' : 'å¼‚å¸¸'}}
        </text>
      </view>
      <text class="network-type">ç½‘ç»œç±»å‹: {{checkResults.results.network.networkType}}</text>
    </view>

    <!-- å­˜å‚¨æƒé™æ£€æŸ¥ -->
    <view class="check-item">
      <view class="check-header">
        <text class="check-title">ğŸ’¾ å­˜å‚¨æƒé™</text>
        <text class="check-status {{checkResults.results.storage.hasStorage ? 'success' : 'error'}}">
          {{checkResults.results.storage.hasStorage ? 'æ­£å¸¸' : 'å¼‚å¸¸'}}
        </text>
      </view>
    </view>

    <!-- APIæœåŠ¡æ£€æŸ¥ -->
    <view class="check-item">
      <view class="check-header">
        <text class="check-title">ğŸ”Œ APIæœåŠ¡</text>
        <text class="check-status {{checkResults.results.api.isAvailable ? 'success' : 'error'}}">
          {{checkResults.results.api.isAvailable ? 'æ­£å¸¸' : 'å¼‚å¸¸'}}
        </text>
      </view>
    </view>

    <!-- æœåŠ¡çŠ¶æ€ -->
    <view class="check-item">
      <view class="check-header">
        <text class="check-title">â˜ï¸ äº‘æœåŠ¡çŠ¶æ€</text>
        <text class="check-status {{checkResults.serviceStatus.isCloudAvailable ? 'success' : 'warning'}}">
          {{checkResults.serviceStatus.isCloudAvailable ? 'å¯ç”¨' : 'ä¸å¯ç”¨'}}
        </text>
      </view>
      <text class="service-type">æœåŠ¡ç±»å‹: {{checkResults.serviceStatus.cloudType}}</text>
    </view>

    <!-- å»ºè®® -->
    <view wx:if="{{checkResults.recommendations.length > 0}}" class="recommendations">
      <text class="recommendations-title">ğŸ’¡ å»ºè®®</text>
      <text wx:for="{{checkResults.recommendations}}" wx:key="*this" class="recommendation-item">
        â€¢ {{item}}
      </text>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="actions">
      <button class="action-btn primary" bindtap="onRetest">ğŸ”„ é‡æ–°æµ‹è¯•</button>
      <button class="action-btn secondary" bindtap="onViewReport">ğŸ“Š æŸ¥çœ‹æŠ¥å‘Š</button>
    </view>
  </view>

  <!-- ä½¿ç”¨è¯´æ˜ -->
  <view class="instructions">
    <text class="instructions-title">ğŸ“– ä½¿ç”¨è¯´æ˜</text>
    <text class="instruction-item">1. å¦‚æœæ˜¾ç¤ºå…¼å®¹æ€§é—®é¢˜ï¼Œè¯·æ›´æ–°å¾®ä¿¡å¼€å‘è€…å·¥å…·</text>
    <text class="instruction-item">2. ç¡®ä¿åŸºç¡€åº“ç‰ˆæœ¬åœ¨2.19.4æˆ–ä»¥ä¸Š</text>
    <text class="instruction-item">3. æ£€æŸ¥ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸</text>
    <text class="instruction-item">4. å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š</text>
  </view>
</view>

<!--pages/account/account.wxml-->
<view class="account-container">
  <!-- 顶部导航 -->
  <view class="nav-bar">
    <view class="nav-content">
      <view class="nav-left" bindtap="goBack">
        <text class="nav-icon">←</text>
      </view>
      <text class="nav-title">账户管理</text>
      <view class="nav-right"></view>
    </view>
  </view>

  <!-- 用户信息卡片 -->
  <view class="profile-section">
    <view class="profile-card">
      <view class="profile-header">
        <view class="avatar-container">
          <image class="avatar" src="{{userInfo.avatar || '/images/tabbar/my.png'}}" mode="aspectFill" />
          <view class="avatar-edit" bindtap="changeAvatar">
            <text class="edit-icon">📷</text>
          </view>
        </view>
        <view class="profile-info">
          <text class="username">{{userInfo.username || '未登录'}}</text>
          <text class="user-id">ID: {{userInfo.id || '000000'}}</text>
          <view class="user-status">
            <view class="status-dot {{userInfo.isOnline ? 'online' : 'offline'}}"></view>
            <text class="status-text">{{userInfo.isOnline ? '在线' : '离线'}}</text>
          </view>
        </view>
      </view>
      
      <view class="profile-stats">
        <view class="stat-item">
          <text class="stat-number">{{userInfo.noteCount || 0}}</text>
          <text class="stat-label">笔记</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{userInfo.followers || 0}}</text>
          <text class="stat-label">关注者</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{userInfo.following || 0}}</text>
          <text class="stat-label">关注中</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 功能分类 -->
  <view class="function-sections">
    <!-- 账户设置 -->
    <view class="section">
      <view class="section-title">⚙️ 账户设置</view>
      <view class="function-grid">
        <view class="function-item" bindtap="editProfile">
          <view class="function-icon profile-icon">👤</view>
          <text class="function-name">编辑资料</text>
        </view>
        <view class="function-item" bindtap="changePassword">
          <view class="function-icon password-icon">🔒</view>
          <text class="function-name">修改密码</text>
        </view>
        <view class="function-item" bindtap="privacySettings">
          <view class="function-icon privacy-icon">🛡️</view>
          <text class="function-name">隐私设置</text>
        </view>
        <view class="function-item" bindtap="notificationSettings">
          <view class="function-icon notification-icon">🔔</view>
          <text class="function-name">通知设置</text>
        </view>
      </view>
    </view>

    <!-- 数据管理 -->
    <view class="section">
      <view class="section-title">💾 数据管理</view>
      
      <!-- 同步状态卡片 -->
      <view class="sync-status-card" wx:if="{{syncStatus.totalCount > 0}}">
        <view class="sync-header">
          <text class="sync-title">📊 同步状态</text>
          <text class="sync-progress">{{syncStatus.syncProgress}}%</text>
        </view>
        <view class="sync-stats">
          <view class="sync-stat-item">
            <text class="sync-stat-number">{{syncStatus.syncedCount}}</text>
            <text class="sync-stat-label">已同步</text>
          </view>
          <view class="sync-stat-item">
            <text class="sync-stat-number">{{syncStatus.unsyncedCount}}</text>
            <text class="sync-stat-label">未同步</text>
          </view>
          <view class="sync-stat-item">
            <text class="sync-stat-number">{{syncStatus.totalCount}}</text>
            <text class="sync-stat-label">总计</text>
          </view>
        </view>
        <view class="sync-progress-bar">
          <view class="sync-progress-fill" style="width: {{syncStatus.syncProgress}}%"></view>
        </view>
      </view>
      
      <view class="function-grid">
        <view class="function-item" bindtap="syncToServer">
          <view class="function-icon sync-up-icon">☁️↑</view>
          <text class="function-name">同步到服务器</text>
          <text class="function-badge" wx:if="{{syncStatus.unsyncedCount > 0}}">{{syncStatus.unsyncedCount}}</text>
        </view>
        <view class="function-item" bindtap="syncFromServer">
          <view class="function-icon sync-down-icon">☁️↓</view>
          <text class="function-name">从服务器下载</text>
        </view>
        <view class="function-item" bindtap="createBackup">
          <view class="function-icon backup-icon">💾</view>
          <text class="function-name">创建备份</text>
        </view>
        <view class="function-item" bindtap="cleanOldData">
          <view class="function-icon clean-icon">🧹</view>
          <text class="function-name">清理旧数据</text>
        </view>
        <view class="function-item" bindtap="viewDataStats">
          <view class="function-icon stats-icon">📊</view>
          <text class="function-name">数据统计</text>
        </view>
        <view class="function-item" bindtap="clearCache">
          <view class="function-icon cache-icon">🗑️</view>
          <text class="function-name">清理缓存</text>
        </view>
      </view>
    </view>

    <!-- 存储信息 -->
    <view class="section">
      <view class="section-title">📱 存储信息</view>
      <view class="storage-card">
        <view class="storage-item">
          <view class="storage-icon">📱</view>
          <view class="storage-content">
            <text class="storage-title">本地存储</text>
            <text class="storage-desc">已使用 {{storageInfo.localUsed || '0'}}MB / {{storageInfo.localTotal || '100'}}MB</text>
          </view>
          <view class="storage-progress">
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{storageInfo.localPercent || 0}}%"></view>
            </view>
            <text class="progress-text">{{storageInfo.localPercent || 0}}%</text>
          </view>
        </view>
        
        <view class="storage-details">
          <view class="detail-item">
            <text class="detail-label">笔记数据</text>
            <text class="detail-value">{{storageInfo.notesCount || '0'}} 条</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">账户数据</text>
            <text class="detail-value">{{storageInfo.accountsCount || '0'}} 个</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">标签数据</text>
            <text class="detail-value">{{storageInfo.tagsCount || '0'}} 个</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 高级功能 -->
    <view class="section">
      <view class="section-title">🔧 高级功能</view>
      <view class="function-grid">
        <view class="function-item" bindtap="saveToDanAccount">
          <view class="function-icon dan-icon">💾</view>
          <text class="function-name">保存到Dan账户</text>
        </view>
        <view class="function-item" bindtap="viewDanAccount">
          <view class="function-icon view-icon">👤</view>
          <text class="function-name">查看Dan账户</text>
        </view>
        <view class="function-item" bindtap="openDataRecovery">
          <view class="function-icon recovery-icon">🔄</view>
          <text class="function-name">数据恢复</text>
        </view>
        <view class="function-item" bindtap="openNetworkDiagnosis">
          <view class="function-icon network-icon">🌐</view>
          <text class="function-name">网络诊断</text>
        </view>
      </view>
    </view>

    <!-- 帮助与反馈 -->
    <view class="section">
      <view class="section-title">❓ 帮助与反馈</view>
      <view class="function-grid">
        <view class="function-item" bindtap="contactUs">
          <view class="function-icon contact-icon">💬</view>
          <text class="function-name">意见反馈</text>
        </view>
        <view class="function-item" bindtap="checkUpdate">
          <view class="function-icon update-icon">🔄</view>
          <text class="function-name">检查更新</text>
        </view>
        <view class="function-item" bindtap="aboutApp">
          <view class="function-icon about-icon">ℹ️</view>
          <text class="function-name">关于应用</text>
        </view>
        <view class="function-item" bindtap="logout">
          <view class="function-icon logout-icon">🚪</view>
          <text class="function-name">退出登录</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 开发者工具（测试用） -->
  <view class="dev-section">
    <button class="dev-btn" bindtap="quickLogin">快速登录（开发测试）</button>
  </view>
</view>

















